# Ψηφιακή Επεξεργασία Εικόνας

### -Εργασία 2-
Hough, Harris, Rot και αποκοπή εικόνων
Α. Ντελόπουλος
Άνοιξη 2020

### 1 Εισαγωγικά
πρέπει να χρησιμοποιήσετε για να δώσετε λύση στο τελικό, real life, πρόβλημα (Ενότητα 2). Πιο συγκεκριμένα, θα
υλοποιήσετε:
1. Τον μετασχηματισμό Hough
2. Τον Harris corner detector
3. Την περιστροφή εικόνας

#### 1.1 Hough transform
Η εργαλειοθήκη ξεκινάει με την κατασκευή μιας ρουτίνας που υλοποιεί τον μετασχηματισμό Hough. Πιο συγκε-
κριμένα, κατασκευάστε την συνάρτηση:
```
function [H, L, res] = myHoughTransform(img_binary , Drho , Dtheta , n)
```
η οποία λαμβάνει ως είσοδο μία binary εικόνα img_binary η οποία έχει προέλθει από κατωφλίωση της εξόδου
ενός edge detector1 για μία grayscale εικόνα, την διακριτότητα Drho στην διάσταση  στο πεδίο του Hough μετρούμενη
σε pixels και την διακριτότητα Dtheta του  στο πεδίο του Hough μετρούμενη σε rads.
Η συνάρτηση επιστρέφει τον πίνακα μετασχηματισμού Hough H και τον πίνακα L με τις παραμέτρους rho και
theta των n ισχυρότερων ευθειών, των ευθειών δηλαδή που αντιστοιχούν στα n μεγαλύτερα τοπικά μέγιστα του
πίνακα H. Η συνάρτηση επιστρέφει επίσης το πλήθος res των σημείων της εικόνας εισόδου που δεν ανήκουν στις n
ευθείες που έχουν εντοπιστεί.

##### 1.1.1 Παραδοτέα
Να κατασκευάσετε το MATLAB script deliverable_1.m στο οποίο θα δείχνετε:
1. Τον πίνακα μετασχηματισμού H2 και να τονίσετε πάνω στην εικόνα τις κορυφές (πίνακας L) που εντοπίσατε.
2. Χρωματίστε τις ευθείες που εντοπίσατε πάνω στην αρχική εικόνα εισόδου.
Και για τα δύο παραδοτέα της ενότητας να χρησιμοποιήσετε την εικόνα im2.jpg που σας δίνεται μαζί με την
εκφώνηση σαν εικόνα εισόδου.

#### Harris corner detector
Για τον εντοπισμό σημείων ενδιαφέροντος θα υλοποιήσετε τον αλγόριθμο Harris corner detector που πρωτοπρο-
τάθηκε στο το άρθρο [C. Harris and M. Stephens, A Combined Corner and Edge Detector, Proceedings of the 4th Alvey Vision Conference,
August 1988, pp. 147-151]. Ακολουθεί η βασική ιδέα. Ας υποθέσουμε ότι w(x1; x2) είναι μία διδιάστατη συνάρτηση που
έχει μή μηδενικές τιμές κοντά στην αρχή των αξόνων και “πεθαίνει” καθώς το (x1; x2) απομακρύνεται από το (0; 0).
Κατασκευάστε την συνάρτηση:
```
function corners = myDetectHarrisFeatures(I)
```
η οποία υλοποιεί τον αλγόριθμο, όπως περιγράφεται παραπάνω. Η μεταβλητή I είναι ένας πίνακας 2 διαστάσεων
και περιέχει μία εικόνα σε gray scale, με τιμές πραγματικούς αριθμούς στο διάστημα [0; 1]. Η μεταβλητή corners είναι
ένας πίνακας δύο στηλών, και κάθε του γραμμή αντιστοιχεί στις συντεταγμένες μίας γωνίας. Ο αλγόριθμος είναι ήδη
υλοποιημένος στο Image Processing toolbox της MATLAB. Οι παρακάτω εντολές επιδεικνύουν τη χρήση του:
```
I=imread('cameraman.tif');
corners=detectHarrisFeatures(I);
figure
hold on
imshow(I);
plot(corners);
hold off
```
Μπορείτε να χρησιμοποιήσετε τη μεταβλητή corners.Location για να επαληθεύσετε την υλοποίησή σας συγκρί-
νοντας τα δικά σας αποτελέσματα με αυτά της έτοιμης συνάρτησης. Η ορθότητα της υλοποίησης δεν εξαρτάται προ-
φανώς από την σειρά με την οποία παρατίθενται οι γωνίες.

##### 1.2.1 Παραδοτέα
Να κατασκευάσετε το MATLAB script deliverable_2.m στο οποίο θα δείχνετε:
1. Τις γωνίες που εντοπίσατε πάνω στην grayscale εικόνα εισόδου δημιουργώντας ένα κόκκινο τετράγωνο 5  5
pixels με κέντρο την κάθε εντοπισμένη κορυφή.
Για το παραδοτέο της ενότητας να χρησιμοποιήσετε την εικόνα im2.jpg που σας δίνεται μαζί με την εκφώνηση
σαν εικόνα εισόδου.

#### Rotation
Κατασκευάστε την συνάρτηση:
```
function rotImg = myImgRotation(img , angle)
```
η οποία θα λαμβάνει σαν είσοδο μία εικόνα img και θα την περιστρέφει αντίστροφα από την φορά του ρολογιού
κατά γωνία angle σε rads. Η συνάρτηση σας θα πρέπει να λειτουργεί ανεξάρτητα του αριθμού των καναλιών της
εικόνας εισόδου (π.χ. RGB ή grayscale). H εικόνα εξόδου rotImg θα πρέπει να έχει τις κατάλληλες διαστάσεις για να
χωράει ολόκληρη την εικόνα εισόδου μετά την περιστροφή της. Υποθέστε ότι το background είναι μαύρο.
Η ιδέα πίσω από την περιστροφή της εικόνας είναι να βρείτε την αντιστοίχιση του κάθε pixel στην μετασχηματι-
σμένη εικόνα ως προς την αρχική εικόνα εισόδου. Για παράδειγμα, αντί να πείτε πως το pixel με συντεταγμένες (1,1)
στην αρχική εικόνα είναι το pixel με συντεταγμένες (3.4, 6.1) στην μετασχηματισμένη, θα πρέπει να κάνετε το αντίθετο
(πως το pixel με συντεταγένες (1,1) στην μετασχηματισμένη εικόνα είναι το pixel (.4, 1.4) της αρχικής. Επιπλέον, θεω-
ρήστε bilinear interpolation (Παράδειγμα στον πίνακα 2) για να υπολογίσετε την τιμή του pixel. Οποιαδήποτε
στρογγυλοποίηση συντεταγμένων pixel προκύψει να είναι προς τα κάτω. Τέλος, για τις οριακές περιπτώσεις μπορείτε
να θεωρήσετε πως η εικόνα εισόδου επεκτείνεται στο άπειρο με μαύρα pixels.

##### Παραδοτέα
Να κατασκευάσετε το MATLAB script deliverable_3.m στο οποίο θα:
1. Πραγματοποιήστε περιστροφή της εικόνας εισόδου κατά 54◦  /180◦ rads, δείξτε το αποτέλεσμα.
2. Πραγματοποιήστε περιστροφή της εικόνας εισόδου κατά 213◦  /180◦ rads, δείξτε το αποτέλεσμα.
Και για τα δύο παραδοτέα της ενότητας να χρησιμοποιήσετε την εικόνα im2.jpg που σας δίνεται μαζί με την
εκφώνηση σαν εικόνα εισόδου. Οι περιστροφές είναι ανεξάρτητες η μία από την άλλη.

### Το πρόβλημα
Σε αυτή την ενότητα θα χρησιμοποιήσετε τις τρομερές γνώσεις που έχετε αποκτήσει μέχρι τώρα στην ψηφιακή
επεξεργασία εικόνας καθώς και τις συναρτήσεις που έχετε φτιάξει σε αυτή την εργασία για να λύσετε το παρακάτω
πρόβλημα.
Θεωρήστε πως η εικόνα εισόδου που σας δόθηκε δημιουργήθηκε από μια άτακτη τοποθέτηση εγγράφων πάνω
στην επιφάνεια ενός scanner. Παρά την αδιανόητη τεμπελιά μας θα θέλαμε να έχουμε μια ψηφιοποιήμενη έκδοση κάθε
εγγράφου που τοποθετήσαμε στο scanner. Για να γίνει αυτό, ο αλγόριθμος σας θα πρέπει να εντοπίζει κάθε ένα από τα
έγγραφα τις εικόνας (ή όσα περισσότερα μπορείτε), να τα απομονώνει, στην συνέχεια να τα περιστρέφει κατάλληλα
και τέλος να τα αποθηκεύει σαν ανεξάρτητες εικόνες στο ίδιο format με την εικόνα εισόδου και πρόσθετη κατάληξη
_1, _2 κ.λπ.
Φτιάξτε το MATLAB script με όνομα myLazyScanner.m το οποίο θα φορτώνει την εικόνα εισόδου με στόχο την
ανεξάρτητη ψηφιοποίηση των εγγράφων της. Το script θα πρέπει να ζεί στο ίδιο directory με τις συναρτήσεις σας. Το
script πρέπει να μας πληροφορεί πόσες εικόνες εντόπισε και πόσες τελικά πέτυχε να γράψει στο δίσκο σαν αυτόνομα
αρχεία.
Να δείξετε την λειτουργία της μεθόδού σας και για τις πέντε εικόνες που σας δίνονται μαζί με την εκφώνηση.
Τέλος, είναι απαραίτητο το script σας να λειτουργεί χωρίς a-priori γνώση της εικόνας εισόδου και να λειτουργεί με τις
ίδιες παραμέτρους για όλες τις εικόνες εισόδου (one-script-fits-all λογική).

# ΒΑΘΜΟΣ: 10.5/10
